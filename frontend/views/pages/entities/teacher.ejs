<!DOCTYPE html>
<html lang="en">
    <head>
        <%- include('../../partials/head'); %>
        <script src="teacherspace.js" defer></script>
    </head>

    <body>
        <header>
            <%- include('../../partials/header'); %>
        </header>

        <main>
            <h1>Teacher</h1>
            <!--If Teacher and Classroom exists, render a table; otherwise throw an error paragraph-->
            <% if ((typeof teacher !== "undefined" && typeof classroom !== "undefined") && (teacher && classroom)) { %>

                <!-- Find classroom capacity -->
                <div class="find-room-capacity">
                    <h2>Find Room Capacity</h2>
                    <ul>
                        <li>
                            <label for="findRoom">Classroom: </label>
                                <select name="findRoom" id="findRoom">
                                    <% for (let instance of classroom) { %>
                                        <option value="<%= instance["CLASS_ID"] %>"><%= instance["CLASS_NAME"] %></option>
                                    <% } %>
                                </select>
                        </li>
                        <li>
                            <label for="findSpaces">Space Amount: </label>
                            <input type="text" id="findSpaces" name="findSpaces" readonly>
                        </li>
                        <li>
                            <label for="findTeacherAmt">Total Teachers: </label>
                            <input type="text" id="findTeacherAmt" name="findTeacherAmt" readonly>
                        </li>
                        <li>
                            <label for="findSpaceRemain">Spaces Remaining: </label>
                            <input type="text" id="findSpaceRemain" name="findSpaceRemain" readonly>
                        </li>
                        <li>
                            <button id="clickSpaceInfo">Find Space</button>
                        </li>
                    </ul>
                </div>

                <!--Add a Teacher-->
                <form action="/add_teacher" method="post">
                    <h2>Add</h2>
                    <ul>
                        <li>
                            <label for="TEACHER_FNAME">First Name: </label>
                            <input type="text" id="TEACHER_FNAME" name="TEACHER_FNAME" required>
                        </li>
                        <li>
                            <label for="TEACHER_LNAME">Last Name: </label>
                            <input type="text" id="TEACHER_LNAME" name="TEACHER_LNAME" required>
                        </li>
                        <li>
                            <label for="CLASS_ID">Classroom: </label>
                            <select name="CLASS_ID" id="CLASS_ID">
                                <% for (let instance of classroom) { %>
                                    <option value="<%= instance["CLASS_ID"] %>"><%= instance["CLASS_NAME"] %></option>
                                <% } %>
                            </select>
                        </li>
                        <li>
                            <button type="submit">Add</button>
                        </li>
                    </ul>
                </form>

                <!--Update Teacher-->
                <form action="/update_teacher" method="post">
                    <h2>Update</h2>
                    <ul>
                        <li>
                            <label for="updateTeacherChoice">Teacher: </label>
                            <select name="choice" id="updateTeacherChoice" required>
                                <option value=""></option>
                                <% for (let instance of teacher) { %>
                                    <option value="<%= instance["TEACHER_ID"] %>"><%= instance["TEACHER_FNAME"] %> <%= instance["TEACHER_LNAME"] %></option>
                                <% } %>
                            </select>
                        </li>
                        <li>
                            <label for="TEACHER_FNAME">First Name: </label>
                            <input type="text" id="TEACHER_FNAME" name="TEACHER_FNAME">
                        </li>
                        <li>
                            <label for="TEACHER_LNAME">Last Name: </label>
                            <input type="text" id="TEACHER_LNAME" name="TEACHER_LNAME">
                        </li>
                        <li>
                            <label for="CLASS_ID">Classroom: </label>
                            <select name="CLASS_ID" id="CLASS_ID">
                                <option value=""></option>
                                <% for (let instance of classroom) { %>
                                    <option value="<%= instance["CLASS_ID"] %>"><%= instance["CLASS_NAME"] %></option>
                                <% } %>
                            </select>
                        </li>
                        <li>
                            <button type="submit">Update</button>
                        </li>
                    </ul>
                </form>

                <!-- Delete a teacher -->
                <form action="/delete_teacher" method="post">
                    <h2>Delete</h2>
                    <ul>
                        <li>
                            <label for="deleteTeacherChoice">Teacher: </label>
                            <select name="choice" id="deleteTeacherChoice" required>
                                <option value=""></option>
                                <% for (let instance of teacher) { %>
                                    <option value="<%= instance["TEACHER_ID"] %>"><%= instance["TEACHER_FNAME"] %> <%= instance["TEACHER_LNAME"] %></option>
                                <% } %>
                            </select>
                        </li>
                        <li>
                            <button type="submit">Delete</button>
                        </li>
                    </ul>
                </form>
                
                <!--Quick Table Summary: Get All-->
                <table>
                    <tr>
                        <th>First Name</th>
                        <th>Last Name</th>
                        <th>Assigned Classroom</th>
                        <th>Room Capacity</th>
                    </tr>
                    <% for (let instance of teacher) { %>
                        <tr>
                            <td><%= instance["TEACHER_FNAME"] %></td>
                            <td><%= instance["TEACHER_LNAME"] %></td>
                            <% for (let jnstance of classroom) { %>
                                <% if (instance["CLASS_ID"] == jnstance["CLASS_ID"]) { %>
                                    <td><%= jnstance["CLASS_NAME"] %></td>
                                    <td><%= jnstance["CLASS_CAPACITY"] %></td>
                                <% } %>
                            <% } %>
                        </tr>
                    <% } %> 
                </table>
            <% } else { %>
                <p>No data in the table exists</p>
            <% } %>
        </main>

        <footer>
            <%- include('../../partials/footer'); %>
        </footer>
    </body>
</html>